<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="student">
	
	<select id="selectList" parameterType="int" resultType="map">
	
		<![CDATA[
		
				select          no,
				                name,
				                email,
				                phone_num phoneNum,
				                join.approval approval
				from users u,   (select      user_no,
											 approval
				                 from        join_users
				                 where class_no = #{classNo} and type = '학생') join
				where u.no = join.user_no				
		]]>
		
		
	</select>
	
	<select id="selNo" parameterType="int" resultType="int">
		
		<![CDATA[
			select      min(join_no)
			from        join_users
			where       class_no = #{classNo} and approval = '승인' and type= '학생'		
		]]>
		
	</select>
	
	
	
	
	
	<update id="updateApprove" parameterType="int">
		
		<![CDATA[
			update		join_users
			set			approval = '승인'
		]]>	
			where		user_no in
			<foreach collection="array" item="no" separator="," open="(" close=")">
				#{no}
			</foreach>		
			
	</update>
			 
	<update id="updateWait" parameterType="int">
		
		<![CDATA[
			update		join_users
			set			approval = '대기'
		]]>	
			where		user_no in
			<foreach collection="array" item="no" separator="," open="(" close=")">
				#{no}
			</foreach>		
			
	</update>
	
	
	
	<update id="updateDelete" parameterType="int">
		
		<![CDATA[
			update		join_users
			set			approval = '탈퇴'
		]]>	
			where		user_no in
			<foreach collection="array" item="no" separator="," open="(" close=")">
				#{no}
			</foreach>		
			
	</update>
	
	
	
</mapper>